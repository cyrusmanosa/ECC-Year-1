
/*
データベース演習I 課題12
クラス：SK1A04
制作者：文家俊
作成日：2023/01/26
*/


mysql> source database12.sql
--------------
ALTER TABLE BIKE ADD FOREIGN KEY (STORE_NO)REFERENCES STORE (STORE_NO)
--------------

Query OK, 2 rows affected (0.22 sec)
Records: 2  Duplicates: 0  Warnings: 0

--------------
SHOW CREATE TABLE BIKE
--------------

+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| BIKE  | CREATE TABLE `bike` (
  `BIKE_NO` char(5) COLLATE utf8mb4_unicode_ci NOT NULL,
  `BNAME` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  `BUY_DATE` date NOT NULL,
  `LENGTH` int DEFAULT NULL,
  `HEIGHT` int DEFAULT NULL,
  `WIDTH` int DEFAULT NULL,
  `SEAT_HEIGHT` int DEFAULT NULL,
  `WEIGHT` int DEFAULT NULL,
  `CAPACITY` double(4,1) DEFAULT NULL,
  `DISPLACEMENT` int DEFAULT NULL,
  `STORE_NO` char(3) COLLATE utf8mb4_unicode_ci NOT NULL,
  PRIMARY KEY (`BIKE_NO`),
  KEY `STORE_NO` (`STORE_NO`),
  CONSTRAINT `bike_ibfk_1` FOREIGN KEY (`STORE_NO`) REFERENCES `store` (`STORE_NO`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci |
+-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

--------------
ALTER TABLE EMPLOYEE ADD FOREIGN KEY (WORK_STORE) REFERENCES store (STORE_NO)
--------------

Query OK, 18 rows affected (0.15 sec)
Records: 18  Duplicates: 0  Warnings: 0

--------------
ALTER TABLE EMPLOYEE ADD FOREIGN KEY (JOB_NO)REFERENCES JOB (JOB_NO)
--------------

Query OK, 18 rows affected (0.15 sec)
Records: 18  Duplicates: 0  Warnings: 0

--------------
SHOW CREATE TABLE EMPLOYEE
--------------

+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| EMPLOYEE | CREATE TABLE `employee` (
  `EMP_NO` char(5) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `ENAME` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `BIRTHDAY` date NOT NULL,
  `TEL` varchar(10) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `ADDRESS` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `HIREDATE` date DEFAULT NULL,
  `JOB_NO` int DEFAULT NULL,
  `RANK_POINT` int NOT NULL,
  `SALARY` int NOT NULL,
  `WORK_STORE` char(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `MGR_NO` char(5) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`EMP_NO`),
  UNIQUE KEY `TEL` (`TEL`),
  KEY `WORK_STORE` (`WORK_STORE`),
  KEY `JOB_NO` (`JOB_NO`),
  CONSTRAINT `employee_ibfk_1` FOREIGN KEY (`WORK_STORE`) REFERENCES `store` (`STORE_NO`),
  CONSTRAINT `employee_ibfk_2` FOREIGN KEY (`WORK_STORE`) REFERENCES `store` (`STORE_NO`),
  CONSTRAINT `employee_ibfk_3` FOREIGN KEY (`JOB_NO`) REFERENCES `job` (`JOB_NO`),
  CONSTRAINT `employee_chk_1` CHECK ((`SALARY` >= 0))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

--------------
ALTER TABLE RECIPE ADD FOREIGN KEY ( PRODUCT_NO ) REFERENCES product ( PRODUCT_NO )
--------------

Query OK, 55 rows affected (0.14 sec)
Records: 55  Duplicates: 0  Warnings: 0

--------------
ALTER TABLE RECIPE ADD FOREIGN KEY ( MATERIAL_NO ) REFERENCES material ( MATERIAL_NO )
--------------

Query OK, 55 rows affected (0.16 sec)
Records: 55  Duplicates: 0  Warnings: 0

--------------
SHOW CREATE TABLE RECIPE
--------------

+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| RECIPE | CREATE TABLE `recipe` (
  `PRODUCT_NO` char(4) COLLATE utf8mb4_unicode_ci NOT NULL,
  `MATERIAL_NO` char(5) COLLATE utf8mb4_unicode_ci NOT NULL,
  `QUANTITY` int NOT NULL,
  PRIMARY KEY (`PRODUCT_NO`,`MATERIAL_NO`),
  KEY `MATERIAL_NO` (`MATERIAL_NO`),
  CONSTRAINT `recipe_ibfk_1` FOREIGN KEY (`PRODUCT_NO`) REFERENCES `product` (`PRODUCT_NO`),
  CONSTRAINT `recipe_ibfk_2` FOREIGN KEY (`MATERIAL_NO`) REFERENCES `material` (`MATERIAL_NO`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

--------------
INSERT INTO MATERIAL( MATERIAL_NO , MNAME , ORIGIN , COST )
VALUES ('00025','牛乳','北海道','30'),
	   ('00026','バナナ','フィリピン','30'),
	   ('00027','桃','岡山','30'),
	   ('00028','みかん','和歌山','30')
--------------

Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

--------------
INSERT INTO RECIPE ( PRODUCT_NO , MATERIAL_NO , QUANTITY )
VALUES ('9003','00025','1'),
	   ('9003','00026','1'),
	   ('9003','00027','1'),
	   ('9003','00028','1')
--------------

ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`studb`.`recipe`, CONSTRAINT `recipe_ibfk_1` FOREIGN KEY (`PRODUCT_NO`) REFERENCES `product` (`PRODUCT_NO`))
--------------
ALTER TABLE RECIPE DROP FOREIGN KEY recipe_ibfk_1
--------------

Query OK, 0 rows affected (0.07 sec)
Records: 0  Duplicates: 0  Warnings: 0

--------------
SHOW CREATE TABLE RECIPE
--------------

+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                   |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| RECIPE | CREATE TABLE `recipe` (
  `PRODUCT_NO` char(4) COLLATE utf8mb4_unicode_ci NOT NULL,
  `MATERIAL_NO` char(5) COLLATE utf8mb4_unicode_ci NOT NULL,
  `QUANTITY` int NOT NULL,
  PRIMARY KEY (`PRODUCT_NO`,`MATERIAL_NO`),
  KEY `MATERIAL_NO` (`MATERIAL_NO`),
  CONSTRAINT `recipe_ibfk_2` FOREIGN KEY (`MATERIAL_NO`) REFERENCES `material` (`MATERIAL_NO`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci |
+--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

--------------
INSERT INTO RECIPE ( PRODUCT_NO , MATERIAL_NO , QUANTITY )
VALUES ('9003','00025','1'),
	   ('9003','00026','1'),
	   ('9003','00027','1'),
	   ('9003','00028','1')
--------------

Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

--------------
COMMIT
--------------

Query OK, 0 rows affected (0.01 sec)

--------------
SELECT * FROM RECIPE WHERE PRODUCT_NO = '9003'
--------------

+------------+-------------+----------+
| PRODUCT_NO | MATERIAL_NO | QUANTITY |
+------------+-------------+----------+
| 9003       | 00025       |        1 |
| 9003       | 00026       |        1 |
| 9003       | 00027       |        1 |
| 9003       | 00028       |        1 |
+------------+-------------+----------+
4 rows in set (0.00 sec)

mysql> notee
