
/*
データベース演習I 課題7
クラス：SK1A 04
制作者：文家俊
作成日：2020/11/24
*/

mysql> source database7.sql
--------------
SELECT RANK_NAME , RANK_DESC, LO_POINT, HI_POINT
FROM RANKPOINT
--------------

+--------------------+--------------------------------------------------------------------------------------+----------+----------+
| RANK_NAME          | RANK_DESC                                                                            | LO_POINT | HI_POINT |
+--------------------+--------------------------------------------------------------------------------------+----------+----------+
| ビギナー           | 仕事内容が未習得の従業員。ベテラン以上と一緒に仕事を行う                             |        0 |      500 |
| ミドル             | ピークタイム以外であれば仕事を1人でこなせる                                          |      501 |     2000 |
| ベテラン           | 見本となる勤務が出来てビギナーに仕事を教えることが出来る                             |     2001 |     4000 |
| エキスパート       | ピークタイム時に主軸となれる人材                                                     |     4001 |     8000 |
| マスター           | 仕事に精通しており最高峰のサービスを提供できる人材                                   |     8001 |     9999 |
+--------------------+--------------------------------------------------------------------------------------+----------+----------+
5 rows in set (0.00 sec)

--------------
SELECT E.EMP_NO , E.ENAME , E.RANK_POINT , R.RANK_NAME
FROM EMPLOYEE AS E JOIN RANKPOINT AS R
ON E.RANK_POINT >= '2001' AND R.RANK_NAME = 'ベテラン'
--------------

+--------+--------------+------------+--------------+
| EMP_NO | ENAME        | RANK_POINT | RANK_NAME    |
+--------+--------------+------------+--------------+
| 00001  | 小林友治     |       2500 | ベテラン     |
| 00002  | 小林圭輔     |       2500 | ベテラン     |
| 00006  | 村上信五     |       2500 | ベテラン     |
| 00016  | 升野英知     |       2500 | ベテラン     |
+--------+--------------+------------+--------------+
4 rows in set (0.04 sec)

--------------
SELECT S.SNAME ,S.STATUS ,E.EMP_NO ,E.ENAME ,E.JOB 
FROM EMPLOYEE AS E JOIN STORE AS S 
ON E.WORK_STORE = S.STORE_NO AND S.HOLIDAY = '土日'
--------------

+--------------+-----------+--------+-----------------+--------+
| SNAME        | STATUS    | EMP_NO | ENAME           | JOB    |
+--------------+-----------+--------+-----------------+--------+
| 生駒店       | 閉店済    | 00001  | 小林友治        | 店長   |
| 阿倍野店     | 営業中    | 00011  | 秋元真夏        | 調理   |
| 阿倍野店     | 営業中    | 00012  | 生田絵梨花      | 配達   |
| 阿倍野店     | 営業中    | 00014  | 白石麻衣        | 調理   |
| 阿倍野店     | 営業中    | 00015  | 高山一実        | 受付   |
| 阿倍野店     | 営業中    | 00016  | 升野英知        | 店長   |
| 阿倍野店     | 営業中    | 00017  | 松村沙友理      | 配達   |
+--------------+-----------+--------+-----------------+--------+
7 rows in set (0.00 sec)

--------------
SELECT S.PREFECTURES AS '店舗エリア' , COUNT(E.WORK_STORE) AS '人数'
FROM STORE AS S JOIN EMPLOYEE AS E
ON E.WORK_STORE = S.STORE_NO
GROUP BY PREFECTURES
--------------

+-----------------+--------+
| 店舗エリア      | 人数   |
+-----------------+--------+
| 奈良県          |      1 |
| 大阪府          |     15 |
+-----------------+--------+
2 rows in set (0.00 sec)

--------------
SELECT * FROM RECIPE
--------------

+------------+-------------+----------+
| PRODUCT_NO | MATERIAL_NO | QUANTITY |
+------------+-------------+----------+
| 0001       | 00001       |        1 |
| 0001       | 00002       |        2 |
| 0001       | 00012       |        1 |
| 0001       | 00014       |        3 |
| 0001       | 00020       |        1 |
| 0002       | 00001       |        1 |
| 0002       | 00006       |        3 |
| 0002       | 00007       |        3 |
| 0002       | 00010       |        1 |
| 0002       | 00015       |        1 |
| 0002       | 00016       |        1 |
| 0002       | 00020       |        1 |
| 0003       | 00001       |        1 |
| 0003       | 00003       |        1 |
| 0003       | 00011       |        1 |
| 0003       | 00014       |        1 |
| 0003       | 00015       |        1 |
| 0003       | 00020       |        1 |
| 0004       | 00001       |        1 |
| 0004       | 00006       |        2 |
| 0004       | 00007       |        2 |
| 0004       | 00008       |        2 |
| 0004       | 00020       |        1 |
| 0005       | 00001       |        1 |
| 0005       | 00008       |        2 |
| 0005       | 00009       |        2 |
| 0005       | 00013       |        1 |
| 0005       | 00021       |        1 |
| 0006       | 00001       |        1 |
| 0006       | 00009       |        3 |
| 0006       | 00018       |        1 |
| 0006       | 00020       |        1 |
| 0006       | 00021       |        1 |
| 9001       | 00001       |        1 |
| 9001       | 00002       |        2 |
| 9001       | 00003       |        2 |
| 9001       | 00004       |        2 |
| 9001       | 00005       |        2 |
| 9001       | 00023       |        1 |
| 9002       | 00001       |        1 |
| 9002       | 00012       |        1 |
| 9002       | 00014       |        1 |
| 9002       | 00015       |        1 |
| 9002       | 00016       |        1 |
| 9002       | 00017       |        1 |
| 9002       | 00018       |        1 |
| 9002       | 00019       |        1 |
| 9002       | 00021       |        1 |
| 9003       | 00001       |        1 |
| 9003       | 00003       |        1 |
| 9003       | 00011       |        1 |
| 9003       | 00014       |        1 |
| 9003       | 00015       |        1 |
| 9003       | 00022       |        1 |
+------------+-------------+----------+
54 rows in set (0.00 sec)

--------------
SELECT P.PNAME , M.MNAME , M.ORIGIN , R.QUANTITY
FROM PRODUCT AS P JOIN MATERIAL AS M JOIN RECIPE AS R
ON M.MATERIAL_NO = R.MATERIAL_NO
ON P.PRODUCT_NO = R.PRODUCT_NO
WHERE P.PNAME = 'マルゲリータ'
GROUP BY MNAME
--------------

+--------------------+-----------------------------+--------------+----------+
| PNAME              | MNAME                       | ORIGIN       | QUANTITY |
+--------------------+-----------------------------+--------------+----------+
| マルゲリータ       | チーズ                      | 北海道       |        1 |
| マルゲリータ       | モッツァレラチーズ          | 北海道       |        2 |
| マルゲリータ       | バジル                      | イタリア     |        1 |
| マルゲリータ       | トマト                      | 熊本         |        3 |
| マルゲリータ       | トマトソース                | NULL         |        1 |
+--------------------+-----------------------------+--------------+----------+
5 rows in set (0.00 sec)

--------------
SELECT P.PNAME , SUM(M.COST * R.QUANTITY) AS '商品原価'
FROM PRODUCT AS P JOIN RECIPE AS R ON P.PRODUCT_NO = R.PRODUCT_NO
JOIN MATERIAL AS M ON M.MATERIAL_NO = R.MATERIAL_NO
GROUP BY PNAME
--------------

+--------------------------+--------------+
| PNAME                    | 商品原価     |
+--------------------------+--------------+
| マルゲリータ             |         1575 |
| デラックスピザ           |         2245 |
| シーフードピザ           |         1110 |
| ギガミート               |         1860 |
| チキン＆ベーコン         |         1595 |
| BBQチキン                |         1350 |
+--------------------------+--------------+
6 rows in set (0.00 sec)

mysql> notee
