/*
データベース演習I 課題6
クラス：SK1A 04
制作者：文家俊
作成日：2020/11/17
*/

mysql> source database6.sql
--------------
SELECT MIN(HIREDATE) AS '入社日' FROM EMPLOYEE
--------------

+------------+
| 入社日     |
+------------+
| 2007-06-15 |
+------------+
1 row in set (0.04 sec)

--------------
SELECT MAX(RANK_POINT) AS '最大ポイント',MIN(RANK_POINT) AS '最小ポイント'
FROM EMPLOYEE
--------------

+--------------------+--------------------+
| 最大ポイント       | 最小ポイント       |
+--------------------+--------------------+
|               2500 |                100 |
+--------------------+--------------------+
1 row in set (0.00 sec)

--------------
SELECT AVG(SALARY) AS '平均時給' FROM EMPLOYEE
WHERE JOB != '店長'
--------------

+--------------+
| 平均時給     |
+--------------+
|     907.5000 |
+--------------+
1 row in set (0.00 sec)

--------------
SELECT WORK_STORE AS '店舗コード',AVG(SALARY) AS '平均時給' FROM EMPLOYEE
WHERE JOB != '店長'
GROUP BY WORK_STORE
--------------

+-----------------+--------------+
| 店舗コード      | 平均時給     |
+-----------------+--------------+
| 001             |     916.6667 |
| 002             |     917.5000 |
| 005             |     894.0000 |
+-----------------+--------------+
3 rows in set (0.00 sec)

--------------
SELECT JOB AS '職種' , COUNT(EMP_NO) AS '人数' FROM EMPLOYEE
GROUP BY JOB
--------------

+--------+--------+
| 職種   | 人数   |
+--------+--------+
| 店長   |      4 |
| 受付   |      3 |
| 配達   |      5 |
| 調理   |      4 |
+--------+--------+
4 rows in set (0.00 sec)

--------------
SELECT WORK_STORE AS '店舗コード', JOB AS '職種',FORMAT(AVG(SALARY),0) AS '平均時給'
FROM EMPLOYEE
GROUP BY WORK_STORE,JOB
ORDER BY AVG(SALARY) DESC
--------------

+-----------------+--------+--------------+
| 店舗コード      | 職種   | 平均時給     |
+-----------------+--------+--------------+
| 003             | 店長   | 5,000        |
| 001             | 店長   | 2,875        |
| 002             | 店長   | 2,875        |
| 005             | 店長   | 2,000        |
| 001             | 受付   | 950          |
| 002             | 配達   | 945          |
| 005             | 調理   | 920          |
| 001             | 配達   | 900          |
| 001             | 調理   | 900          |
| 002             | 調理   | 890          |
| 002             | 受付   | 890          |
| 005             | 受付   | 890          |
| 005             | 配達   | 870          |
+-----------------+--------+--------------+
13 rows in set (0.00 sec)

--------------
SELECT COUNT(DISTINCT MGR_NO) AS 'マネージャの人数' FROM EMPLOYEE
--------------

+--------------------------+
| マネージャの人数         |
+--------------------------+
|                        4 |
+--------------------------+
1 row in set (0.00 sec)

--------------
SELECT MGR_NO AS 'マネージャ番号',COUNT(MGR_NO) AS 'マネージャの人数' FROM EMPLOYEE
WHERE MGR_NO IS NOT NULL
GROUP BY MGR_NO
--------------

+-----------------------+--------------------------+
| マネージャ番号        | マネージャの人数         |
+-----------------------+--------------------------+
| 00001                 |                        3 |
| 00002                 |                        3 |
| 00006                 |                        4 |
| 00016                 |                        5 |
+-----------------------+--------------------------+
4 rows in set (0.00 sec)

--------------
SELECT MGR_NO AS 'マネージャ番号',COUNT(MGR_NO) AS 'マネージャの人数' FROM EMPLOYEE
WHERE MGR_NO IS NOT NULL
GROUP BY MGR_NO
HAVING COUNT(MGR_NO) <= 4
--------------

+-----------------------+--------------------------+
| マネージャ番号        | マネージャの人数         |
+-----------------------+--------------------------+
| 00001                 |                        3 |
| 00002                 |                        3 |
| 00006                 |                        4 |
+-----------------------+--------------------------+
3 rows in set (0.00 sec)

--------------
SELECT DATE_FORMAT(HIREDATE,'%Y') AS '入社年度',COUNT(EMP_NO) FROM EMPLOYEE
GROUP BY DATE_FORMAT(HIREDATE,'%Y')
ORDER BY DATE_FORMAT(HIREDATE,'%Y')
--------------

+--------------+---------------+
| 入社年度     | COUNT(EMP_NO) |
+--------------+---------------+
| 2007         |             1 |
| 2010         |             3 |
| 2013         |             5 |
| 2015         |             3 |
| 2016         |             2 |
| 2020         |             1 |
| 2022         |             1 |
+--------------+---------------+
7 rows in set (0.00 sec)

mysql> notee
